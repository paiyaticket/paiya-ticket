<section class="grid">
    <div class="col-12 sm:col-12 md:col-12 lg:col-3 xl:col-3">
        <span class="text-4xl text-blue-500 font-bold">Création d'un évènement</span>
        <p class="text-800" i18n>
            L'évènement est au coeur de votre activité. Ça peut être un concert, un salon, un festival, une simple réunion. 
            Ça peut être un rassemblement physique ou virtuel! Pour vue que des gens se rassemble, au une date précise ou une cause commune.
            Donnez le plus de détail possible.
        </p>
    </div>
    <div class="col-12 sm:col-12 md:col-12 lg:col-9 xl:col-9">
        <form [formGroup]="eventForm" (ngSubmit)="submit()">
            <p-fieldset legend="Images et vidéos" i18n-legend="Images et vidéos" styleClass="mt-4 hover:border-blue-400 border-3">

            </p-fieldset>

            <p-fieldset legend="Vue d'ensemble" i18n-legend="Vue d'ensemble" styleClass="mt-4 hover:border-blue-400 border-3" class="">
                <div class="formgrid grid">
                    <div class="field xl:col-12 lg:col-12 col-12">
                        <label for="title" class="font-bold" i18n>Titre</label>
                        <p class="text-800" i18n>
                            Soyez clair et descriptif avec un titre qui indique aux gens en quoi consiste votre événement.
                        </p>

                        <input id="title" type="text" pInputText class="w-full" formControlName="title">
            
                        <div *ngIf="title?.invalid && (title?.touched || title?.dirty)">
                            @if (title?.hasError('required')) {
                                <small id="title-required-help" [hidden]="title?.pristine || title?.valid" class="p-error font-bold" i18n="Un titre est requis.">
                                    Un titre est requis.
                                </small>
                            }
                        </div>
                    </div>

                    <div class="field xl:col-12 lg:col-12 col-12 mt-4">
                        <label for="summary" class="font-bold" i18n>Resumé</label>
                        <p class="text-800" i18n>
                            Attirez l'attention des gens avec une brève description de votre événement. 
                            Les participants le verront en haut de la page de votre événement. (150 caractères maximum)
                        </p>

                        <textarea id="summary" pInputTextarea class="w-full" formControlName="summary" autoResize="true"></textarea>
            
                        @if (summary?.invalid && (summary?.touched || title?.dirty)) {
                            <div>
                                @if (summary?.invalid  && (summary?.touched || summary?.dirty)) {
                                    @if (summary?.hasError('maxlength')) {
                                        <small id="summary-required-help" class="p-error font-bold" i18n="Nombre maximum de caratère atteint.">
                                            Le nombre maximum de caratère ({{ eventForm.get('summary')?.getError('maxlength').requiredLength}}) est atteint. 
                                            Nombre actuel de caratère saisi: {{ eventForm.get('summary')?.getError('maxlength').actualLength}}.
                                        </small>
                                    }
                                }
                            </div>
                        }
                    </div>

                </div>
            </p-fieldset>

            <p-fieldset legend="Date et lieu" i18n-legend="Vue d'ensemble" styleClass="mt-4 hover:border-blue-400 border-3">
                <div class="formgrid grid">
                    <div class="field xl:col-12 lg:col-12 col-12">
                        <p-selectButton 
                            [options]="eventTypeOptions" 
                            formControlName="eventType" 
                            optionValue="value" 
                            optionLabel="label"
                            (onChange)="onEventTypeChange($event)"
                            styleClass="w-full">
                                <ng-template let-item pTemplate>
                                    <div>
                                        <div class="font-bold text-2xl" i18n>{{ item.label }}</div> 
                                        
                                        <span class="text-800" i18n>{{ item.description }}</span>
                                    </div>
                                </ng-template>
                        </p-selectButton>
                    </div>

                    @if (selectedEventType?.valueOf() === 'Sigle Event') {
                        <!-- DATE -->
                        <div class="field xl:col-4 lg:col-4 col-12 mt-2">
                            <label for="date" class="font-bold" i18n>Date</label>
    
                            <p-calendar id="date" formControlName="date" dateFormat="dd-mm-yy" class="w-full" styleClass="w-full" (onSelect)="onDateSelect($event)"/>
                
                            <div *ngIf="date?.invalid && (date?.touched || date?.dirty)">
                                @if (date?.hasError('required')) {
                                    <small id="date-required-help" [hidden]="date?.pristine || date?.valid" class="p-error font-bold" i18n="Une date est requise.">
                                        Une date est requise.
                                    </small>
                                }
                            </div>
                        </div>
    
                        <!-- START TIME -->
                        <div class="field xl:col-4 lg:col-4 col-12 mt-2">
                            <label for="startTime" class="font-bold" i18n>Heure de début</label>
    
                            <p-calendar id="startTime" formControlName="startTime" timeOnly="true" dateFormat="HH:mm" class="w-full" styleClass="w-full" (onSelect)="onTimeSelect($event)"/>
                
                            <div *ngIf="startTime?.invalid && (startTime?.touched || startTime?.dirty)">
                                @if (startTime?.hasError('required')) {
                                    <small id="startTime-required-help" [hidden]="startTime?.pristine || startTime?.valid" class="p-error font-bold" i18n="Une heure est requise.">
                                        Une heure est requise.
                                    </small>
                                }
                            </div>
                            @if (eventForm.hasError('laterDate')) {
                                <small id="startTime-required-help" class="p-error font-bold" i18n="La date de début doit être inférieure à la date de fin.">
                                    La date de début doit être inférieure à la date de fin.
                                </small>
                            }
                        </div>
    
                        <!-- END TIME -->
                        <div class="field xl:col-4 lg:col-4 col-12 mt-2">
                            <label for="endTime" class="font-bold" i18n>Heure de fin</label>
    
                            <p-calendar id="endTime" formControlName="endTime" timeOnly="true" dateFormat="HH:mm" class="w-full" styleClass="w-full" (onSelect)="onTimeSelect($event)"/>
                
                            <div *ngIf="endTime?.invalid && (endTime?.touched || endTime?.dirty)">
                                @if (endTime?.hasError('required')) {
                                    <small id="endTime-required-help" [hidden]="endTime?.pristine || endTime?.valid" class="p-error font-bold" i18n="Une heure est requise.">
                                        Une heure est requise.
                                    </small>
                                }
                            </div>
                            @if (eventForm.hasError('laterDate')) {
                                <small id="endTime-required-help" class="p-error font-bold" i18n="La date de fin doit être supérieure à la date de début.">
                                    La date de fin doit être supérieure à la date de début.
                                </small>
                            }
                        </div>

                        <!-- LOCATION -->
                        <div class="field xl:col-12 lg:col-12 col-12 mt-2" formGroupName="physicalAddress">
                            <label for="location" class="font-bold" i18n>Lieu</label>
                            
                            <input id="location" type="text" pInputText class="w-full" formControlName="title">
            
                            <div *ngIf="location?.invalid && (location?.touched || location?.dirty)">
                                @if (location?.hasError('required')) {
                                    <small id="location-required-help" [hidden]="location?.pristine || location?.valid" class="p-error font-bold" i18n="Une adresse est requise.">
                                        Une adresse est requise.
                                    </small>
                                }
                            </div>

                            <p-panel header="Plus de détails sur l'adresse" [toggleable]="true" [collapsed]="true" [iconPos]="'start'" class="mt-2" styleClass="location-details w-full">
                                
                                <div class="formgrid grid">
                                    <div class="field xl:col-12 lg:col-12 col-12 mt-2">
                                        <label for="locationIndication" class="font-bold" i18n>Indication supplémentaire</label>
                                        <textarea id="locationIndication" rows="2" pInputTextarea formControlName="locationIndication" class="w-full" autoResize="true"></textarea>
                                    </div>
                                    <div class="field xl:col-3 lg:col-3 col-12 mt-2">
                                        <label for="streetNumber" class="font-bold" i18n>Numéro de rue</label>
                                        <input id="streetNumber" type="text" pInputText class="w-full" formControlName="streetNumber">
                                    </div>
                                    <div class="field xl:col-3 lg:col-3 col-12 mt-2">
                                        <label for="street" class="font-bold" i18n>Nom de rue</label>
                                        <input id="street" type="text" pInputText class="w-full" formControlName="street">
                                    </div>
                                    <div class="field xl:col-3 lg:col-3 col-12 mt-2">
                                        <label for="town" class="font-bold" i18n>Ville</label>
                                        <input id="town" type="text" pInputText class="w-full" formControlName="town">
                                    </div>
                                    <div class="field xl:col-3 lg:col-3 col-12 mt-2">
                                        <label for="postalCode" class="font-bold" i18n>Code postal</label>
                                        <input id="postalCode" type="text" pInputText class="w-full" formControlName="postalCode">
                                    </div>
                                    <div class="field xl:col-4 lg:col-4 col-12 mt-2">
                                        <label for="state" class="font-bold" i18n>Province ou Région ou État</label>
                                        <input id="state" type="text" pInputText class="w-full" formControlName="state">
                                    </div>
                                    <div class="field xl:col-4 lg:col-4 col-12 mt-2">
                                        <label for="country" class="font-bold" i18n>Pays</label><br>
                                        <p-dropdown id="country" [options]="countries" formControlName="country" optionValue="name" optionLabel="name" [filter]="true"
                                            filterBy="name" styleClass="w-full" placeholder="Choisir un pays" i18n-placeholder="Choisir un pays" 
                                            i18n-placeholder="Select a country"/>
                                    </div>

                                </div>
                                
                            </p-panel>
                        </div>
                    } @else {
                        <div class="field xl:col-12 lg:col-12 col-12">
                            <p-messages [(value)]="messages" [enableService]="false" [closable]="false" />
                        </div>
                    }
                </div>
                
            </p-fieldset>

            <p-fieldset legend="Bon à savoir" i18n-legend="Bon à savoir" styleClass="mt-4 hover:border-blue-400 border-3">

            </p-fieldset>

            <div class="mt-4 flex justify-content-end flex-wrap">
                <p-button type="button" label="Annuler" i18n-label="Annuler" styleClass="bg-primary-reverse mr-2" 
                    (onClick)="goToEventListPage()" icon="pi pi-times"></p-button>
                <p-button type="submit" label="Sauvegarder et continuer" i18n-label="Sauvegarder et continuer" styleClass="m-auto"
                    icon="pi pi-save" [disabled]="eventForm.invalid"></p-button>
            </div>
        </form>
    </div>
</section>